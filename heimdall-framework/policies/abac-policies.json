{
  "policies": [
    {
      "id": "abac-department-match",
      "name": "Department Match Policy",
      "description": "Users can access resources from their own department",
      "effect": "allow",
      "priority": 100,
      "conditions": [
        {
          "attribute": "subject.department",
          "operator": "equals",
          "value": "{{resource.department}}"
        }
      ]
    },
    {
      "id": "abac-clearance-level-required",
      "name": "Clearance Level Requirement",
      "description": "Users must have sufficient clearance level for classified resources",
      "effect": "allow",
      "priority": 200,
      "conditions": [
        {
          "attribute": "subject.clearanceLevel",
          "operator": "in",
          "value": ["high", "top-secret"]
        },
        {
          "attribute": "resource.dataClassification",
          "operator": "in",
          "value": ["confidential", "restricted", "top-secret"],
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "abac-project-access",
      "name": "Project Access Policy",
      "description": "Users can access resources from projects they have access to",
      "effect": "allow",
      "priority": 150,
      "conditions": [
        {
          "attribute": "subject.projectAccess",
          "operator": "contains",
          "value": "{{resource.project}}"
        }
      ]
    },
    {
      "id": "abac-certification-required",
      "name": "Certification Requirement",
      "description": "Users must have required certifications to access certain resources",
      "effect": "allow",
      "priority": 180,
      "conditions": [
        {
          "attribute": "subject.certifications",
          "operator": "contains",
          "value": "{{resource.requiresCertification}}"
        }
      ]
    },
    {
      "id": "abac-location-based",
      "name": "Location-Based Access",
      "description": "Users can only access resources from approved locations",
      "effect": "allow",
      "priority": 120,
      "conditions": [
        {
          "attribute": "context.location",
          "operator": "in",
          "value": ["headquarters", "office", "research-lab"]
        },
        {
          "attribute": "resource.dataClassification",
          "operator": "in",
          "value": ["confidential", "restricted"],
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "abac-time-based-restriction",
      "name": "Time-Based Access Restriction",
      "description": "Restricted resources only accessible during business hours",
      "effect": "allow",
      "priority": 130,
      "conditions": [
        {
          "attribute": "context.timeOfDay",
          "operator": "regex",
          "value": "^(0[8-9]|1[0-8]):"
        },
        {
          "attribute": "resource.dataClassification",
          "operator": "equals",
          "value": "restricted",
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "abac-employment-type-restriction",
      "name": "Employment Type Restriction",
      "description": "Contractors cannot access restricted resources",
      "effect": "deny",
      "priority": 300,
      "conditions": [
        {
          "attribute": "subject.employmentType",
          "operator": "equals",
          "value": "contractor"
        },
        {
          "attribute": "resource.dataClassification",
          "operator": "in",
          "value": ["restricted", "top-secret"],
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "abac-region-based",
      "name": "Region-Based Access",
      "description": "Users can access resources from their region",
      "effect": "allow",
      "priority": 110,
      "conditions": [
        {
          "attribute": "subject.location",
          "operator": "equals",
          "value": "{{resource.region}}"
        }
      ]
    },
    {
      "id": "agent-delegated-access",
      "name": "Delegated Agent Access Policy",
      "description": "Agents acting on behalf of users inherit user permissions",
      "effect": "allow",
      "priority": 250,
      "conditions": [
        {
          "attribute": "context.agentType",
          "operator": "equals",
          "value": "delegated"
        },
        {
          "attribute": "subject.userPermissions",
          "operator": "contains",
          "value": "{{action}}:{{resource.type}}",
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "agent-direct-access",
      "name": "Direct Agent Access Policy",
      "description": "Autonomous agents can access resources based on their configured scopes",
      "effect": "allow",
      "priority": 260,
      "conditions": [
        {
          "attribute": "context.agentType",
          "operator": "equals",
          "value": "direct"
        },
        {
          "attribute": "subject.agentScopes",
          "operator": "contains",
          "value": "{{action}}:{{resource.type}}",
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "agent-permission-boundary",
      "name": "Agent Permission Boundary Policy",
      "description": "Agents cannot exceed user permissions in delegated access scenarios",
      "effect": "deny",
      "priority": 400,
      "conditions": [
        {
          "attribute": "context.agentType",
          "operator": "equals",
          "value": "delegated"
        },
        {
          "attribute": "subject.userPermissions",
          "operator": "notIn",
          "value": ["{{action}}:{{resource.type}}", "{{action}}:*", "*:*"],
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "agent-dynamic-access-jit",
      "name": "Agent Just-in-Time Access Policy",
      "description": "Agents can request dynamic access with proper context",
      "effect": "allow",
      "priority": 270,
      "conditions": [
        {
          "attribute": "context.jitAccess",
          "operator": "equals",
          "value": true
        },
        {
          "attribute": "context.ipAddress",
          "operator": "notEquals",
          "value": null,
          "logicalOperator": "AND"
        },
        {
          "attribute": "context.timeOfDay",
          "operator": "notEquals",
          "value": null,
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "agent-multi-service-access",
      "name": "Agent Multi-Service Access Policy",
      "description": "Agents can access multiple services with consistent permissions",
      "effect": "allow",
      "priority": 280,
      "conditions": [
        {
          "attribute": "context.serviceAccess",
          "operator": "notEquals",
          "value": null
        },
        {
          "attribute": "context.serviceAccess",
          "operator": "contains",
          "value": "{{resource.type}}",
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "agent-audit-requirement",
      "name": "Agent Audit Requirement Policy",
      "description": "All agent actions must be audited",
      "effect": "allow",
      "priority": 500,
      "conditions": [
        {
          "attribute": "context.agentType",
          "operator": "in",
          "value": ["delegated", "direct"]
        },
        {
          "attribute": "context.auditEnabled",
          "operator": "equals",
          "value": true,
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "agent-time-based-restriction",
      "name": "Agent Time-Based Restriction",
      "description": "Agents accessing restricted resources must respect time windows",
      "effect": "allow",
      "priority": 290,
      "conditions": [
        {
          "attribute": "resource.dataClassification",
          "operator": "in",
          "value": ["restricted", "top-secret"]
        },
        {
          "attribute": "context.timeOfDay",
          "operator": "regex",
          "value": "^(0[8-9]|1[0-8]):",
          "logicalOperator": "AND"
        }
      ]
    },
    {
      "id": "agent-location-based-restriction",
      "name": "Agent Location-Based Restriction",
      "description": "Agents accessing confidential resources must be from approved locations",
      "effect": "allow",
      "priority": 300,
      "conditions": [
        {
          "attribute": "resource.dataClassification",
          "operator": "in",
          "value": ["confidential", "restricted", "top-secret"]
        },
        {
          "attribute": "context.location",
          "operator": "in",
          "value": ["headquarters", "office", "research-lab"],
          "logicalOperator": "AND"
        }
      ]
    }
  ]
}

